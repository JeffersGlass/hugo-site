---
title: "Improving Website Hits with AWS Cloudfront Stats"
date: 2022-03-13T17:54:43-05:00
draft: true
static_slug: /img/cloudresumeslug.png
tags:
- Cloud-Resume
---
<p class="post-p">I was digging around in the available statistics for this very site on <a href="post/Cloud-Resume-Challenge-Cloudfront-for-HTTPs">my Cloudfront Distribution</a>, when I came across an interesting chart.</p>
<img src="dailyhits.PNG" alt="A chart showing the total requests per day for this website. The hits range from roughly one thousand to over 2500" class="post-img lg:w-2/5">
<p class="post-p">Wow, almost 2500 hits to my Cloudfront cache on 3/8! My site must be getting so much traffic!</p>
<p class="post-p">Or is it? Let's dig futher into the cache stats and see what's happening. The next charge on this page shows percentage of viewer requests by result type and... it doesn't look good. Especially if I stretch it out cover the last month.</p>
<img src="hitsmisses2.PNG" alt="A chart showing the percentage of hits, misses, and errors for users (hosts) requesting pages from this site. Before March 2 they are mostly misses, but on March 2 the errors shoot up wildly." class="post-img">
<p class="post-p">Well, double dang. Two things that jump out immediately:</p>
<ul class="post-ul">
    <li>Before about March 2nd, roughly 60% of the requests to the site were generating misses.</li>
    <li>After about March 2nd, roughly 50% of the requests to the site were generating errors.</li>
</ul>
<p class="post-p">That March 2nd date makes some sense - that's when I officially switched over all (most) of my content from my old wordpress site to this hugo-made site. I finalized this while <a href="project/usitt2022">sitting in a convention hall in Baltimore</a>, so I guess it's not 100% surprising that something was left unaccounted for. And I know that there are a couple pieces of content that I haven't ported over at time of writing (specially, links to the Electronics Bash class pages.) But let's see if we can determine exactly what's failing.</p>
<p class="post-p">The 'Popular Objects' view gives a pretty straightforward view of what users (or scrapers) are looking for. Anything that has 0 cache hits is likely to be something that doesn't exist on our site. And if necessary, we can compare this list to the view of the past month (before and after changeover-day) to see what resources are no longer being found.</p>
<div class="flex"><img src="popularmisses1.PNG" alt="A chart of the most popularly acessed objects on my site in the last 7 days. The most common hits and misses are mentioned in the text." class="post-img lg:w-2/5"><img src="popularmisses2.PNG" alt="A chart of the most popularly acessed objects on my site in the last 7 days. The most common hits and misses are mentioned in the text." class="post-img lg:w-2/5"></div>
<p class="post-p">Wow, almost 2000 requests for <code class="code">/feed</code> in the last week that have gone nowhere. This makes sense - it's a default URL for RSS feeds in a wordpress site. It doesn't look like that's something I broke specifically at my Wordpress transition, but it'd be nice to allow scrapers looking for wordpress sites to actually find my feed, I think. Since the default RSS feed in a Hugo build are at <code class="code">/index.xml</code>, I'd like to <a href="post/cloud-resume-challenge-aliases/">add a redirect</a> to make that happen. Unfortunately, it seems like <a href="https://discourse.gohugo.io/t/rss-url-or-an-alias/35501/2">redirects/aliases in Hugo can only create aliases with an html extention</a>, so I'll need to go about this another way.</p>
<p class="post-p">I was a little worried that I'd hit a dead-end at this point. After all, I'm hosting this static site through S3 specifically to eliminate the need for a webserver, but I assumed I'd need an actual server to create proper 301 redirects. Thankfully, it seems <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/how-to-page-redirect.html">S3 has basic redirect capabilities built in</a> after all. There are options for redirect rules (up to 50), which can handle redirecting by prefix, postfix, error code, etc, though only 50 rules are allowed per site. Individual objects can also be setup to redirect to other objects, which seems like perhaps what we want in this case.</p>
<p class="post-p">I'll start by createing a file at <code class="code">/static/feed</code> (no suffix), which will appear on my site at <code class="code">https://jeff.glass/feed</code>, the address I want to redirect.</p>