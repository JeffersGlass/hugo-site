---
title: "Quick and Dirty System Startup and Shutdown"
date: 2021-12-28T00:05:00-05:00
draft: true
tags:
- electronics
- arduino
- python
---
<p class="font-bold post-p">Tl;DR Computers hate having their power abruptly cut. A UPS, an Adafruit Feather board, and some python hackery keeps computers booting and shutting down gently when power is yanked and restored.</p>
<p class="post-p"><hr/></p>
<p class="post-p">My dayjob involves solving technical problems for a large, multi-acre education facility with over 400 computer-driven interactives. To prolong the life of these devices (many of which are built around off-the-shelf computers and monitors), we like to power them down after operating hours and start them up in the morning. Just like a PC, these are mostly windows machines, and they <span class="italic">love</span> to be rebooted</p>
<p class="post-p">What makes this challenging is both the number and placement of these devices. While many are in dedicated control rooms with <a href="">linked KVM systems</a>, even using a mouse and keyboard to manually shut down 400 PCs would take the onsite staff far longer than designed, and could be error-prone. Worse, some computers are embedded inside consoles, cabinets, and displays, making the process of walking around and hitting power buttons (where accessible) or using a wireless keyboard (where not) even longer. The same is true of startup, except that a wireless keyboard isn't an option in that case. A central startup and shutdown solution is essential.</p>
<p class="post-p">Of course, there are many ways to make this happen. The most ideal, when the money is available, is to use a central controller, like a <a href="https://medialon.com/products/showmaster-pro/">Medialon System</a>, <a href="https://www.crestron.com/Products/Control-Hardware-Software/Hardware">Creston Controller</a>, <a href="https://derivative.ca/">TouchDesigner interface</a>, or similar. The control is put in charge of signalling the computers to wake up (via Wake-on-LAN), shut down (through  proprietary software modules), and handles cycling <a href="https://www.se.com/us/en/product-range/7340-powerlink-intelligent-panelboards/#overview">remotely-controller AC breakers</a>, turning projcets on and off via various ethernet protocols, and so on. The dream is for whoever's operating the system to press one button (or click one button on a screen) to have the whole system turn on, or off.</p>
<p class="post-p">Life is rarely a dream.</p>
<p class="post-p">We sometimes run into a situation where, for reasons of cost, planning, location, or timing, there is no exterior control of any kind. There's just a breaker in a panel (which may or may not be remote controlled) providing power to an installed cabinet. And as much as PC's love to be rebooted, they <span class="italic">hate</span> having their power yanked unexpectedly.</p>
<p class="post-p">So the challenge is: <span class="font-bold">given only control over their power, can we create a system that soft-starts and soft-shuts-down a PC?</span> <span class="italic">(Yes we can, or this would be a very short post.)</span></p>
<p class="post-p"><hr/></p>
<p class="post-p">test</p>
