<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>industrial-design on Jeff Glass</title>
    <link>https://jeff.glass/tags/industrial-design/</link>
    <description>Recent content in industrial-design on Jeff Glass</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 13 Jul 2020 20:51:45 -0500</lastBuildDate><atom:link href="https://jeff.glass/tags/industrial-design/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Reverse Engineering and Replacing an Industrial 7-Segment Display – Part 2, Investigation</title>
      <link>https://jeff.glass/backup-post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-2-investigation/</link>
      <pubDate>Mon, 13 Jul 2020 20:51:45 -0500</pubDate>
      
      <guid>https://jeff.glass/backup-post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-2-investigation/</guid>
      <description>This is Part 2 of an N-part series. See also [Part 1].</description>
    </item>
    
    <item>
      <title>Reverse Engineering and Replacing an Industrial 7-Segment Display – Part 2, Investigation</title>
      <link>https://jeff.glass/post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-2-investigation/</link>
      <pubDate>Mon, 13 Jul 2020 20:51:45 -0500</pubDate>
      
      <guid>https://jeff.glass/post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-2-investigation/</guid>
      <description>&lt;p class=&#34;post-p&#34;&gt;&lt;em&gt;This is Part 2 of an N-part series. See also [&lt;a href=&#34;../../post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-1-research&#34;&gt;Part 1&lt;/a&gt;].&lt;/em&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;In part one of this series, we began the process of developing a replacement for the LASCAR EM-4-LED 4-digit industrial 7 segment display. To recap: we mined the display&#39;s datasheet for all it we could, then opened up the device to reveal its component parts and continued to dig into their datasheets until we had a reasonably complete view of the device&#39;s functions. With the research phase complete, it&#39;s time to move into in investigation, and we&#39;ll think about how we might begin to probe an unknown device and its connections more specifically.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;em&gt;Author&#39;s Note: The&lt;/em&gt; post &lt;em&gt;has been sitting fully written in my drafts since before things locked-down in mid-March, but was lacking a couple of illustrative screenshots/pictures of the signal-capture process. Since the pandemic&#39;s effects are still dragging on, I&#39;m pushing this post out now with a couple of substitute images - they are noted below where applicable.&lt;/em&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/03/IMG_9557-scaled-e1583250423936.jpg&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;wp-image-799 size-large post-img&#34; height=&#34;669&#34; src=&#34;IMG_9557-scaled-e1583250423936-1024x952.jpg&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-img-caption&#34;&gt;A refresher - this is the little display we are attempting to replace.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;As you move into the phase of actually powering a device up and testing it, there are a few key parameters to keep in mind. Power and signal voltage levels are key - is this a 5V part, perhaps 3.3V, perhaps 12 or 24 or higher for industrial parts? And even if the device has a high or wide-range power voltage, any I/O ports may be more limited. This is why gathering as much data on-paper first is useful: to avoid letting the magic smoke out of the device-under-test before you get all its juicy secrets out.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;Other specs worth keeping in mind are:&lt;/p&gt;
&lt;ul class=&#34;post-ul&#34;&gt;
&lt;li&gt;Voltage level of outputs - can you safely probe all external pins with a TTL logic probe? Do you need to start with an oscilloscope to verify voltage ranges? Or even a multimeter?&lt;/li&gt;
&lt;li&gt;Output clock rates - does your instrumentation have the bandwidth to reveal useful information.&lt;/li&gt;
&lt;li&gt;Open-collector vs. current-source outputs - if you&#39;re expecting to see some output (for driving LEDs, relays, etc), do you need to supply external power to see if anything is actually happening?&lt;/li&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;/p&gt;&lt;/ul&gt;
&lt;p class=&#34;post-p&#34;&gt;Since we have this info (fairly) confidently in hand, let&#39;s dive into probing our hardware and see what new things we can learn.&lt;/p&gt;
&lt;h4 class=&#34;post-h4&#34;&gt;Utilizing a Logic Analyzer&lt;/h4&gt;
&lt;p class=&#34;post-p&#34;&gt;One thing that many folks pointed out &lt;a href=&#34;https://hackaday.com/2019/12/14/what-does-an-electronics-tinkerers-workbench-need/&#34;&gt;in the comments&lt;/a&gt; of &lt;a href=&#34;https://jeff.glass/2019/12/01/electronics-lab-tools/&#34;&gt;my writeup of useful electronics bench tools&lt;/a&gt; was the lack of a logic analyzer on my list. I confess before this project, I had never used one, nor particularly found a need for one. For many years, my primary electrical hobby was amateur radio (indeed, I had a &lt;a href=&#34;http://kk9jef.wordpress.com&#34;&gt;whole separate blog for ham radio pursuits&lt;/a&gt;) - which, as a side note, is also a wonderful place to jump into learning about electricity in a very hands on way. Working in the handfuls-of-megahertz with analog signals, a &lt;a href=&#34;https://kk9jef.wordpress.com/2015/09/16/hello-world-and-a-scope/&#34;&gt;25MHz analog oscilloscope &lt;/a&gt; was a much more useful tool than something that operated only on digital logic. But for this particular project, while a scope is useful for verifying voltage levels and seeing whether a signal is present or not, the right tool for the job is a &lt;span style=&#34;text-decoration: underline;&#34;&gt;logic analyzer.&lt;/span&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/04/old-scope-e1587840938266.jpg&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;size-large wp-image-975 post-img&#34; height=&#34;482&#34; src=&#34;old-scope-e1587840938266-1024x686.jpg&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-img-caption&#34;&gt;The old analog oscilloscope that got me through years of Ham Radio adventures&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;A logic analyzer is a piece of digital test gear that reads the voltage on two or more input connectors and creates a digital representation of the logic-levels of the voltages present over time. So where a digital oscilloscope records and displays analog voltages over time with some degree of precision, a logic analyzer is only interested as to whether the voltage is above or below a threshold, so as to be a logic high or logic low (typically 0v-12v, 0v-5v, 0-3.3v).&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;For talking to some other nerds and receiving some feedback online, it seems like the standout stars in the relatively-low-cost logic analyzer space are the &lt;a href=&#34;https://amzn.to/2S8ryoJ&#34;&gt;offerings from Saleae&lt;/a&gt; and the &lt;a href=&#34;https://amzn.to/2VAhp6y&#34;&gt;Analog Discovery&lt;/a&gt; and &lt;a href=&#34;https://amzn.to/3eTwS9a&#34;&gt;Digital Discovery&lt;/a&gt; from Digilent. All of the above are modules that plug into a computer via USB for their control and display capabilities, so they cannot be used as stand-alone devices in the field. While &lt;a href=&#34;https://amzn.to/2x7aPLd&#34;&gt;some mid-to-high-end oscilloscopes&lt;/a&gt; also have signal-analysis capabilities built in - these are often listed as &#34;mixed signal&#34; oscilloscopes -  those are a bit beyond my current needs at the moment. And in fact, while the Digilent products have had my eye for awhile, as a place to get my feet wet with signal analyzers for this project, I wanted to verify that this would be a useful tool before I committed my department&#39;s funding to a few-hundred-dollar purchase.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/04/oscope.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;size-full wp-image-974 post-img&#34; height=&#34;472&#34; src=&#34;oscope.png&#34; width=&#34;826&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-img-caption&#34;&gt;A fancy Rigol scope with logic analyzer functions - note the multipin connector under the display.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;I ended up with a &lt;a href=&#34;https://amzn.to/3aEAEAa&#34;&gt;$25 8-Channel Sparkfun Logic Analyzer&lt;/a&gt;, which handles 3.3V and 5V signals with a sample rate of us to 24 MHz. This nominally means it can handle digital signals up to about 12 MHz, but in practice, something somewhat lower would be a safer choice. Since the LASCAR display we&#39;re working on has a nominal data rate of 500 KHz, this should be plenty for my purposes.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/04/logicanalyzer.jpg&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;wp-image-972 post-img&#34; height=&#34;400&#34; src=&#34;logicanalyzer.jpg&#34; width=&#34;400&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
The basic 8-channel logic analyzer from Sparkfun
&lt;p class=&#34;post-p&#34;&gt;The Sparkfun Analyzer seems to essentially be a branded version of the many &lt;a href=&#34;https://amzn.to/3eUJnBI&#34;&gt;inexpensive logic analyzers&lt;/a&gt; floating around Amazon - all of which pretty much will work with the open-source logic analysis software &lt;a href=&#34;https://sigrok.org/wiki/PulseView&#34;&gt;PulseView&lt;/a&gt;, which is itself a graphical frontend for the command line program &lt;a href=&#34;https://sigrok.org/&#34;&gt;Sigrok&lt;/a&gt;. While PulseView doesn&#39;t allow access to all of Sigrok&#39;s many capabilities, its a significantly more approachable way to get started with these devices in my opinion.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt; to compile and install PulseView on Ubuntu · &lt;img alt=&#34;One Transistor&#34; class=&#34;post-img&#34; height=&#34;379&#34; src=&#34;https://4.bp.blogspot.com/-3jojqtnZsQM/Wf7ue9r10tI/AAAAAAAAHxI/POypJ6alOhINsrA2Dgtz8zSmgWsw8zUegCLcBGAs/s1600/pulseview-main-window.png&#34; width=&#34;595&#34;/&gt; Pulseview can capture samples and decode them visually for you.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;Sparkfun has already written up a great &lt;a href=&#34;https://learn.sparkfun.com/tutorials/using-the-usb-logic-analyzer-with-sigrok-pulseview/all&#34;&gt;Getting Started with Sigrok, Pulseview, and the Logic Analyzer tutorial&lt;/a&gt;, so I won&#39;t try to duplicate their work here. Suffice to say, after getting the software installed, you attach the ground probe on the analyzer to a ground point on the circuit you&#39;re probing, and attach one or more signal probes to the signal lines you&#39;re like to test. After configuring the sample rate at which you want to capture data points and how many points to capture, you &#34;run&#34; the analyzer, which then then a few seconds to minutes capturing the number of points you selected. After capture, you can select one of a number of &#34;decoders&#34; that attempt to turn the individual high-or-low, one-or-zero datapoints into a structured view of what data contained therein. For example, if you&#39;re probing what you think is a serial UART stream, the UART decoder will give you a view of the data as ASCII characters being transmitted over the UART, which is much easier than looking at pure sample points.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;hr/&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;Here&#39;s a look at the data and power lines going to the existing LASCAR display:&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;(&lt;em&gt;Getting this picture has been pre-empted by a global pandemic! A picture will be here when I can get back in the building someday.&lt;/em&gt;)&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;What a nice set of labels! The presence of the clock and data lines matches with our expectations, since last time we spotted a shift-register built into the brains of the EM-32 display. The shift register will &#34;clock in&#34; or take in one bit of data from the data line each time it transitions, either from low-to-high or high-to-low. So we should expect to see these lines changing in alternation - first, the data line will go low or high to establish the next bit of data, then the clock line will be pulled low or high to tell the shift register to take-in this bit of data.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;Or at least, that&#39;s what I would expect, given the schematics of the EM-32 that we were looking at last time. Probing the signals will hopefully allow us to confirm this. So, let&#39;s hook up a the signal analyzer&#39;s ground to the GND wire and channels 1 and 2 of the analyzer to the CLOCK and DATA lines, here&#39;s what we capture:&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;]&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/07/lascar-cap1.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;wp-image-1221 size-large post-img&#34; height=&#34;121&#34; src=&#34;lascar-cap1-1024x172.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt; &lt;em&gt;This is a substitute image of a different capture - the actual image is inaccessible due to pandemic conditions. But the capture would look much like this.&lt;/em&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;The first thing we note is that the data rate here is nowhere near the 500KHz rate that the datasheet says we can tolerate - we&#39;re seeing about 40 bits of data at a rate of roughly 1KHz, in bursts about 10 times a second. So we can turn our data capture rate waaaay down from its maximum 24 MHz. Which is great. Applying the SPI decoder to this data (which has a similar clock-and-data-lines structure to what we expect) allows us to see a view of the individual 1&#39;s and 0&#39;s that make up the stream of bits coming from the PLC.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;]&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/07/refresh-rate.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;size-full wp-image-1222 post-img&#34; height=&#34;655&#34; src=&#34;refresh-rate.png&#34; width=&#34;804&#34;/&gt;&lt;/a&gt; &lt;em&gt;This is a substitute image of a different capture - the actual image is inaccessible due to pandemic conditions. But the capture would look much like this.&lt;/em&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;Comparing this bitstream with the timing diagram we saw last time, we thankfully see things lining up pretty well - we can see the initial clock pulse and start data bit, which tells the display to begin expecting data, following by 35 bits of data more. The PLC then pauses for approximately 100ms before sending more data.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/timing.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-full wp-image-780 post-img&#34; height=&#34;852&#34; src=&#34;timing.png&#34; width=&#34;947&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;The two major takeaways from our logic-analyzer work are:&lt;/p&gt;
&lt;ul class=&#34;post-ul&#34;&gt;
&lt;li&gt;The bitstream coming from the PLC is as-expected given what we learned from the datasheet, and&lt;/li&gt;
&lt;li&gt;Its datarate is at most 1KHz, in bursts about 10 times a second.&lt;/li&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;/p&gt;&lt;/ul&gt;
&lt;p class=&#34;post-p&#34;&gt;This will help us develop our testing solution - knowing that we have reasonable data rates means that we don&#39;t need to throw anything particularly fancy at this problems in term of hardware.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;/p&gt;
</description>
      &lt;
    </item>
    
    <item>
      <title>Reverse Engineering and Replacing an Industrial 7-Segment Display - Part 1, Research</title>
      <link>https://jeff.glass/backup-post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-1-research/</link>
      <pubDate>Wed, 04 Mar 2020 00:05:00 -0500</pubDate>
      
      <guid>https://jeff.glass/backup-post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-1-research/</guid>
      <description>Building one-off hardware is one part inventing, one part dissecting, one part scrounging.</description>
    </item>
    
    <item>
      <title>Reverse Engineering and Replacing an Industrial 7-Segment Display - Part 1, Research</title>
      <link>https://jeff.glass/post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-1-research/</link>
      <pubDate>Wed, 04 Mar 2020 00:05:00 -0500</pubDate>
      
      <guid>https://jeff.glass/post/reverse-engineering-and-replacing-an-industrial-7-segment-display-part-1-research/</guid>
      <description>&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;Building one-off hardware is one part inventing, one part dissecting, one part scrounging. When we try to hit that magic mixture of good, fast, &lt;em&gt;and&lt;/em&gt; cheap, so often we must rely on prebuilt modules - if we&#39;re trying to build a widget that gets us from zero to 100, it may only be financially/temporarily/technologically reasonable if someone already makes a module that gets us from 0 to 80. Utilizing economies of scale of already-developed parts can bring a one-off project from the realm of fantasy into feasibility.  Often, the solution is to develop a chain of off-the-shelf components that can fulfill the end goal.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;But all components have a service life, and a manufacturing lifetime. And when your part goes out of production and then your spares-bin runs dry, sometimes keeping your machine running requires some deeper problem solving. When you work in the public-facing technology sphere (theatre, museum work, retail displays, etc), a lot of the solutions are literally one-of-a-kind, even if they&#39;re constructed from commercial parts.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;I recently had the need to replace a very specific module in some equipment. While it didn&#39;t end up being the most high-tech/high speed/highfalutin bit of technology, it presents a good opportunity to talk through how one can approach an unknown part, come to understand its workings, and develop a replacement. So in this N-part series, we&#39;ll look at the process of researching, developing, and implementing a custom one-off solution to a failed part in a unique piece of gear.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;hr/&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/03/IMG_9557-scaled-e1583250423936.jpg&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter wp-image-799 size-large post-img&#34; height=&#34;669&#34; src=&#34;IMG_9557-scaled-e1583250423936-1024x952.jpg&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;The &lt;a href=&#34;https://www.alliedelec.com/m/d/535531da0cc330e5c959e59360401632.pdf&#34;&gt;Lascar EM32-4-LED&lt;/a&gt; is a four-digit seven-segment panel mount LED display meant for general-purpose data display. Its small digit size (.39&#34; tall), machined aluminum housing, small footprint (32.5mm diameter punchout) and NEMA 4X/IP67 made it a compact choice for anyone needing to display a single value with 4 digits of precision. It also had the ability to drive four external LEDs, for additional status or process indicators.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;img alt=&#34;Lascar Electronics EM32-4 LED&#34; class=&#34;aligncenter post-img&#34; height=&#34;400&#34; src=&#34;https://assets.alliedelec.com/f_auto,c_scale,w_400/70101381.jpg&#34; width=&#34;400&#34;/&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;A piece of equipment I&#39;ve been working on recently had just such a LASCAR display installed a few years back to serve as a timer. I&#39;&#39;m going to have to be a little vague about the specifics of the equipment itself, but since this post is focused on technical process and not the piece itself, I think I can safely share enough details for the following to make sense:&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;The piece is an interactive object that triggers some actions and servos, demonstrates a physical phenomenon, and then takes about 25 seconds to cool back down before can be used again. The user is presented with a &lt;a href=&#34;https://www.bulgin.com/us/products/stainless-steel-vandal-resistant-illuminated-ip66-push-button-switch-mpi001-mpi002-series-22mm-diameter-group.html&#34;&gt;green illuminated button&lt;/a&gt; to activate the system - when the system is in active or cooling down, the illuminated button turns red. But because it&#39;s not entirely clear from the action of the device alone when it will be cool enough for use, a countdown timer (two digits) is displayed on the EM32 display, counting the number of seconds until we&#39;re good to run again.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;Sadly, this particular EM32 display died shortly after LASCAR decided the product hit its End of Life. What&#39;s more, I&#39;m currently without the ability to modify the programming of the PLC that&#39;s driving the whole shebang. In order to maintain the functionality of the piece, it became necessary to build a device that would ingest the existing signals being sent by the PLC, interpret them, and drive a newly crafted 7-segment display of some kind.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/03/IMG_9967-scaled-e1583254082764.jpg&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-large wp-image-800 post-img&#34; height=&#34;600&#34; src=&#34;IMG_9967-scaled-e1583254082764-1024x853.jpg&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;&lt;a href=&#34;https://www.alliedelec.com/m/d/535531da0cc330e5c959e59360401632.pdf&#34;&gt;The &#39;datasheet&#39; for the EM32-4&lt;/a&gt; is a paltry 2 pages long. Presumably there was additional documentation provided to those who were using the device, but since it&#39;s now EOL, that documentation seems to be unobtanium. But the existing pair of pages does contain some useful information.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;We&#39;ll start at the very beginning (a very good place to start): the &lt;strong&gt;opening&lt;/strong&gt; &lt;strong&gt;prose&lt;/strong&gt; &lt;strong&gt;paragraph&lt;/strong&gt;:&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/Intro.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter wp-image-762 size-large post-img&#34; height=&#34;199&#34; src=&#34;Intro-1024x283.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;This is where we find a high-level overview of the part, it&#39;s intended purpose, and (&lt;em&gt;sometimes&lt;/em&gt;) explanations of the differences between any variants of the part. Say, for example, a given part is made in a standard and a mil-spec version, or a normal and a slew-rate limited version, a manufacturer will often encompass them in a single datasheet. It&#39;s important to identify specifically what part you have, so you can characterize it accurately. &lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;In our case, the EM32-4 is unique enough that there are no major variants. The paragraph mostly tells us what we already know - it&#39;s a 4-digit, 3 decimal point display in a metal bezel. But it does call out the &#34;optional external LEDs.&#34; While it&#39;s unclear at this point exactly what this means, it&#39;s useful to make note of these surprises early on, as they&#39;ll often explain a what-the-heck-is-that moment late in the datasheet.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;Moving on then to the next useful block in just about any datasheet; the electrical specifications. This is where you&#39;ll find input-voltage ranges for power and signals, output voltages and timing, and other device-specific characteristics (transistor beta and voltage spreads, op-amp gain and slew rate, power ratings, etc). If I was doing a &lt;a href=&#34;http://www.nick.com.au/doubledare/videos/double-dare-104-physical-challenge-balloon/&#34;&gt;Double Dare Physical Challenge&lt;/a&gt; and had to utilize a part with only one table of its datasheet available, I&#39;d take the electrical specs chart 9 out of 10 times.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/elecspec.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter wp-image-763 size-large post-img&#34; height=&#34;177&#34; src=&#34;elecspec-1024x252.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;In our case, there&#39;s only 6 lines, but 6 important lines they are. We learn that this is a 5V part, but can run at up to 9V so we can&#39;t assume we&#39;ll have 5V power available. Nominal power  usage is ~20mA, so the power available on existing supply lines may be limited. The operating and storage temperature ranges are typical. V&lt;sub&gt;LED&lt;/sub&gt; is a a bit confusing - does this refer to the display itself, in which case we have no real purpose for this voltage? Or perhaps it refers to the voltage available for the external LEDs. &lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;The final line is promising - that the typical clock input frequency is 500KHz. This is the first we&#39;ve seen any information about how this device receives communication from a controller. But now we know it&#39;s some kind of clocked input (perhaps sometime like SPI?), and that its possible frequency is not unreasonable from something we might interpret with off-the-shelf hardware. Not that 500KHz is a stroll in the park, but it&#39;s not in the many-megahertz range, say.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;The last really useful part of the datasheet is the Functional Block Diagram. This block shows a symbolic representation of what&#39;s happening inside the device, as an aid to the user in visualizing what&#39;s happening on the interior and how we need to interface with it. You really only see this with integrated circuits or other modules (the functional bock diagram of a transistor would be... just a transistor).&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;To highlight the purpose of the block diagram, let&#39;s do a quick comparison between two drawings on another part: the venerable &lt;a href=&#34;https://www.youtube.com/watch?v=fLaexx-NMj8&#34;&gt;555 Timer IC.&lt;/a&gt; Its datasheet sports both a schematic diagram and a functional diagram; here are the two side-by-side:&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/555schem.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter wp-image-767 size-large post-img&#34; height=&#34;336&#34; src=&#34;555schem-1024x478.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/555func.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter wp-image-766 size-full post-img&#34; height=&#34;745&#34; src=&#34;555func.png&#34; width=&#34;778&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;This demonstrates pretty clearly the distinct purposes of the schematic diagram versus the functional one. The functional diagram is there to give users a high-level understanding of how the device functions, where inputs and outputs attach, and what the essential parts of the device are. The schematic diagram is there for those who need to really drill into exactly how the chip is built, because of some precise technical reason. When I&#39;m driving a car, I need to know whether the transmission is manual or automatic, two-wheel vs four wheel, and so on - a functional understanding is enough. A mechanic needs a schematic showing the various linkages and gears of my transmission to diagnose and repair issues; holding that level of information in my head all the time would get in the way of the business of driving around.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;With that diversion hopefully making clear the purpose of the functional block diagram, let&#39;s check out the one for the EM32-4.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/block-diagram.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter wp-image-761 size-full post-img&#34; height=&#34;699&#34; src=&#34;block-diagram.png&#34; width=&#34;850&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;There&#39;s some really good info here! Let&#39;s start with the external connections:&lt;/p&gt;&lt;/p&gt;
&lt;ul class=&#34;post-ul&#34;&gt;
&lt;li style=&#34;text-align: justify;&#34;&gt;We could have guessed V+ and 0V are supply voltage and ground, but this confirms it.&lt;/li&gt;
&lt;li style=&#34;text-align: justify;&#34;&gt;The 35-bit &lt;a href=&#34;https://en.wikipedia.org/wiki/Shift_register&#34;&gt;shift register&lt;/a&gt; is intriguing, and illuminates the purpose of the D (Data) and Ck (Clock) terminals. There&#39;s also an Ē (enable) pin for the data line which is active low (indicated by the bar over the pin name, for &#34;not&#34;). &lt;/li&gt;
&lt;li style=&#34;text-align: justify;&#34;&gt;Since we don&#39;t have direct control over the latches or buffer layer of the shift register, it seems that data will be shown as soon as its clocked in.&lt;/li&gt;
&lt;li&gt;There&#39;s a weird hanging &lt;a href=&#34;https://en.wikipedia.org/wiki/Inverter_(logic_gate)&#34;&gt;inverter&lt;/a&gt; on the left side of the diagram attached to the output buffers, as if there was some kind of external buffer control possible at some point. How odd.&lt;/li&gt;
&lt;li style=&#34;text-align: justify;&#34;&gt;It seems that the  V&lt;sub&gt;L&lt;/sub&gt; pin is on the downstream side from the voltage regulator, so it probably puts out the 3 volts listed under electrical specifications above.
&lt;li&gt;This probably means that L1 thru L4 are &lt;a href=&#34;https://en.wikipedia.org/wiki/Open_collector#:~:text=&#34;&gt;open-collector outputs&lt;/a&gt;, so we have a sense of how we might use the part to drive the external LEDs.&lt;/li&gt;
&lt;li style=&#34;text-align: justify;&#34;&gt;Finally, there&#39;s a Reset pin for soft-resetting the data displayed - this would be useful if the end product was configured so the displayed retained power when the controller turned off - the controller could simply reset the display (or many displays in parallel) to ensure that no data was present for a fresh start.&lt;/li&gt;
&lt;/li&gt;&lt;/ul&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;One of the starting placing for replacing this display was the possibility that there might be some driver circuitry driving a&lt;a href=&#34;https://www.adafruit.com/product/865&#34;&gt; generic 7-segment display&lt;/a&gt;. If the display itself was still good, perhaps we can simply replace the driver and have a visually identical display. Those hopes were dashed, however, when I opened up the EM32-4 LED to find...&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/IMG_9565-scaled.jpg&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-large wp-image-776 post-img&#34; height=&#34;540&#34; src=&#34;IMG_9565-1024x768.jpg&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;An &lt;a href=&#34;http://www.farnell.com/datasheets/83212.pdf&#34;&gt;OEM 4-LED&lt;/a&gt; - the power behind the throne - it&#39;s the same product, right down to the block diagram, but in a DIP-style package. The EM32-4, it turns out, is the OEM-4 with a nice aluminum case and terminal blocks. And the back of the OEM-4 is epoxy-blobbed together, so even if we were to break into the thing, there&#39;s a good chance everything is wirebonded all the way to nowhere and back. Reusing the display on this thing is a non-starter.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;All is not in vain, however - the OEM-4&#39;s datasheet is a whopping &lt;em&gt;four&lt;/em&gt; pages to the EM32&#39;s paltry two. The first two pages are essentially identical (which makes sense, since one &lt;em&gt;is&lt;/em&gt; the other in a very real way), but the two additional pages in the OEM-4&#39;s datasheet have four additional juicy diagrams. Starting with a timing diagram:&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/timing.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-large wp-image-780 post-img&#34; height=&#34;648&#34; src=&#34;timing.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;We can now see in much more detail that, yes indeed, the display is based around an internal shift register architecture, with bits being clocked in and held in the device. We can see that there&#39;s a start bit (&#34;1&#34;) and the 35 data bits we saw in the EM32&#39;s datasheet, so we&#39;ll need to clock 36 physical bits into the device, whereupon it will automatically load the data (presumably into the data latches and output buffer). Then in 30 ns it will automatically reset and be ready The clock timing, which is listed as 500 Khz nominal, can in theory be pushed to 2 MHz if the 500 ns cycle time (250 ns + 250 ns) can be believed. (&lt;em&gt;Not that we&#39;re hoping it&#39;s that high&lt;/em&gt;). We can also get some detail about the external reset signals and the data input timing.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;Remember, all this sleuthing is with a goal -  not of driving an EM32, but of creating a display controller which &lt;em&gt;takes the place of &lt;/em&gt;an EM32 in a specific installation. Any details we can deduce from the datasheets will help us narrow down where we begin with our investigation of the controller itself.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/applications.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-full wp-image-777 post-img&#34; height=&#34;511&#34; src=&#34;applications.png&#34; width=&#34;960&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;The &#34;applications&#34; diagram gives us a few pointers - not all are useful to our goal, but are interesting nonetheless. As we guessed before, the LED1 through LED4 pins are open collector drivers - but unlike our guess, we actually need to provide the +3 volts for that control from an external regulator, not from the V&lt;sub&gt;LED&lt;/sub&gt; pin. And the typical current should be 2.5mA per LED, so there&#39;s aren&#39;t high-current drivers in any sense. We can also see that the OEM-4 module has an option for external brightness control via a 50kΩ potentiometer, but we don&#39;t have the ability to access those pins on the EM32 unit.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;There&#39;s also a sneaky note at the bottom of the diagram that there is a &#39;special version&#39; OEM-4 LED with a built-in 3V regulator and brightness control. I wonder which version we have?&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/ps035.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-large wp-image-778 post-img&#34; height=&#34;573&#34; src=&#34;ps035.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;At first blush the circuit diagram appears to tell us what we already know - there&#39;s a &lt;a href=&#34;https://www.digchip.com/datasheets/parts/datasheet/922/PS035-pdf.php&#34;&gt;shift-register LED driver&lt;/a&gt; inside this thing that&#39;s taking clocked data in and driving LEDs on the downstream side. But there are actually two key things to note here - while I had assumed the V&lt;sub&gt;LED&lt;/sub&gt; pin was only for the external LED&#39;s, it&#39;s actually the anode connection for all the segments of the display! This means that connecting it isn&#39;t optional for driving external LEDs, it&#39;s mandatory if we want the OEM-4 to work. Looking back at the block diagram from the EM32, we can understand the purpose of the built-in regulator shown there.&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/regulator.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;wp-image-784 size-full post-img&#34; height=&#34;282&#34; src=&#34;regulator.png&#34; width=&#34;814&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-img-caption&#34;&gt;The EM32&#39;s built-in 3V regulator on the EM32.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;The second key thing we learn from the circuit diagram is &lt;em&gt;which bits control which segments.&lt;/em&gt; But it&#39;s made even more clear in the final diagram from the OEM-4 datasheet: the serial data input sequence:&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;a href=&#34;https://jeff.glass/wp-content/uploads/2020/02/serial-data.png&#34;&gt;&lt;img alt=&#34;&#34; class=&#34;aligncenter size-large wp-image-779 post-img&#34; height=&#34;326&#34; src=&#34;serial-data.png&#34; width=&#34;720&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;p class=&#34;post-p&#34; style=&#34;text-align: justify;&#34;&gt;Now we don&#39;t have to try to deducing the bit-order from what we think the data stream is displaying, we can build that data into our programming from the beginning. Thank goodness, since I&#39;d never actually seen this display in action before I undertook the task to replace it!&lt;/p&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;&lt;hr class=&#34;wp-block-separator&#34;/&gt;&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;This is about as deep as the research rabbit-hole goes, it seems. We&#39;ve found the datasheet for the EM32 module itself, the OEM-4 module inside it, and the PS035 inside that.&lt;/p&gt;
&lt;p class=&#34;post-p&#34;&gt;In the next post, we&#39;ll start probing the signals coming from the controller, building a version of the display in software, and testing some theories about how the display operates.&lt;/p&gt;
</description>
      &lt;
    </item>
    
  </channel>
</rss>